<ng-include src="'views/header.html'" class="header-wrapper"></ng-include>

<main>
	<!-- This is where all Html for the view goes. -->
	
  <div class="container-fluid">
    <div class="row profile-content">
  		<div class="col-lg-offset-1 col-md-offset-0 col-md-3 col-sm-offset-1 col-sm-11 col-xs-12">        
        	<h1 class="col-xs-12" ng-show="userData.display_name">{{userData.display_name}}</h1>
          <h1 class="col-xs-12" ng-show="!userData.display_name">{{userData.id}}</h1>
          
          <a target="_blank" href="{{userData.external_urls.spotify}}">
          <img class="col-xs-5 col-sm-offset-0 col-sm-5 col-md-9" 
          ng-show="userData.images[0].url" 
          ng-src="{{userData.images[0].url}}"
          alt="No image" ></a>

          <a target="_blank" href="{{userData.external_urls.spotify}}">
          <img class="col-xs-5 col-sm-offset-0 col-sm-5 col-md-9" 
          ng-show="!userData.images[0].url && !loading" 
          ng-src="http://orig13.deviantart.net/c751/f/2010/017/b/3/avatar_self_portrait_by_nuria.jpg" 
          alt="No image"></a>


          <div class="col-xs-12 col-sm-5 col-md-12 info-block">
              <dt class="info-title">Top artist</dt>
              <dd ng-repeat="artist in topArtists">
              <a class="info-text" >{{artist.name}}</a>
              </dd>
          </div>

          <div class="col-xs-12 col-sm-5 col-md-12 info-block">
              <dt class="info-title">Top tracks</dt>
              <dd ng-repeat="track in topTracks">
                <a target ="_blank" class="info-text">{{track.name}} - {{track.artists[0].name}}</a>
              </dd>
          </div>
      </div>
      
      <div class="col-xs-12 col-md-9 col-lg-8">
        <div class="col-sm-12">
          <h1 class="profile-title col-sm-8">Your Playlists</h1>
          <input class="playlist-search col-sm-4" ng-model="search.name" placeholder="Search..." autofocus>
        </div>
      	
      	<div class="grid col-sm-12 col-xs-12">
      		<ul class="col-xs-12 profile-playlists">
      		<li class="inner-grid col-sm-3 col-xs-12" ng-repeat="playlist in playlists | filter: search:strictfunction">

	      		<a href="{{playlist.external_urls.spotify}}">
              <img class="top-images" ng-src="{{playlist.images[0].url}}"/>
            </a>
              <p class="playlist-title">
                {{playlist.name | limitTo:15}}{{playlist.name.length > 15 ? '...' : ''}}
              </p>
              <div class="share-btn" ng-init="checkLink(playlist)">
                <div class="link-space">
                  <a target ="_blank" ng-show="playlist.shared" href="{{playlist.link}}" target="_blank" class="link-text">{{playlist.link}}</a>
                  <p ng-show="!playlist.shared && !loading">Not shared</p>
                  <img class="loading-bar" ng-show="loading" src="/resources/loading-bar.gif" ></img>
                </div>

                <button type="button" ng-show="!playlist.shared" class="btn btn-success" ng-click="genLink(playlist)">
                  <p ng-show="!playlist.generating">Put up to vote</p>
                  <p ng-show="playlist.generating">Creating link...</p>
                </button>

                <button type="button" ng-show="playlist.shared" class="btn btn-danger" ng-click="stopSharing(playlist);playlist.status = false">
                  <p>Close vote</p>
                </button>

              </div>
            </li>   
        </div>
      </div>
    </div>
	</div>

</main>

<ng-include src="'views/footer.html'" class="footer-wrapper"></ng-include>
